<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PhoneBook</title>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js" defer></script>
    <script src="node_modules/vue/dist/vue.global.js" defer></script>
    <script src="node_modules/axios/dist/axios.min.js" defer></script>
    <script src="js/script.js" defer></script>
</head>
<body>
<div class="container" id="app">
    <h1 class="mt-3">PhoneBook</h1>
    <form @submit.prevent="createContact">
        <div class="row">
            <div class="col-lg-5">
                <h2 class="h5">Создать контакт</h2>

                <div class="mb-3">
                    <label for="name" class="form-label">Фамилия</label>
                    <input v-model.trim="surname"
                           :class="{'is-invalid': isSurnameInvalid}"
                           type="text"
                           class="form-control"
                           id="surname">
                    <div class="invalid-feedback">Введите фамилию</div>
                </div>

                <div class="mb-3">
                    <label for="name" class="form-label">Имя</label>
                    <input v-model.trim="name"
                           :class="{'is-invalid': isNameInvalid}"
                           type="text"
                           class="form-control"
                           id="name">
                    <div class="invalid-feedback">Введите имя</div>
                </div>

                <div class="mb-3">
                    <label for="phone" class="form-label">Телефон</label>
                    <input v-model.trim="phone"
                           :class="{'is-invalid': isPhoneInvalid}"
                           type="text"
                           class="form-control"
                           id="phone">
                    <div class="invalid-feedback">Введите номер телефона</div>
                </div>

                <button type="submit" class="btn btn-primary me-3">Создать</button>
                <button @click="clearForm"
                        :class="{'d-none': !isFormCompleted}"
                        v-cloak
                        type="button"
                        class="btn btn-close"></button>
            </div>
        </div>
    </form>

    <h2 class="h5 mt-4">Поиск</h2>

    <form @submit.prevent="getContacts" class="row row-cols-lg-auto g-3 align-items-center">
        <div class="col-lg-4">
            <input v-model="term" type="text" class="form-control">
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Поиск</button>
        </div>
        <div v-cloak :class="{'d-none': isFilterClean}" class="col-auto">
            <button @click="clearFilter" type="button" class="btn btn-close"></button>
        </div>
    </form>

    <div class="mt-3">
        <div v-cloak class="mb-2">
            <button @click="showDeleteSelectedContactsModal"
                    :class="{'invisible': isSelectedContactsMissing}"
                    type="button"
                    class="btn btn-outline-danger border-0">
                Удалить выбранное
            </button>
        </div>

        <div class="table-responsive">
            <table v-cloak class="table table-hover">
                <thead class="table-head table-light">
                <tr>
                    <th class="header-detail"></th>
                    <th class="header-detail">#</th>
                    <th class="header-detail">Фамилия</th>
                    <th class="header-detail">Имя</th>
                    <th class="header-detail">Телефон</th>
                    <th class="header-detail"></th>
                </tr>
                </thead>
                <tbody>
                <tr :class="{'d-none': isContactsExists}">
                    <td colspan="6" class="text-center">Контакты отсутствуют.</td>
                </tr>

                <tr v-for="(contact, index) in contacts" :key="contact.id">
                    <td>
                        <input v-model="selectedContacts"
                               :value=contact
                               class="form-check-input checkbox"
                               type="checkbox">
                    </td>
                    <td>{{ index + 1 }}</td>
                    <td>{{ contact.surname }}</td>
                    <td>{{ contact.name }}</td>
                    <td>{{ contact.phone }}</td>
                    <td>
                        <button @click="showEditContactModal(contact)"
                                class="btn btn-sm btn-outline-primary border-0"
                                type="button">
                            Редактировать
                        </button>

                        <button @click="showDeleteContactModal(contact)"
                                class="btn btn-sm btn-outline-danger border-0"
                                type="button">
                            Удалить
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <edit-contact-modal @save="editContact"
                        v-cloak
                        ref="editContactModal">
    </edit-contact-modal>

    <delete-contact-modal @delete="deleteContact"
                          v-cloak
                          ref="deleteContactModal">
    </delete-contact-modal>

    <delete-selected-contacts-modal @delete="deleteSelectedContacts"
                                    v-cloak
                                    ref="deleteSelectedContactsModal">
    </delete-selected-contacts-modal>
</div>
</body>
</html>